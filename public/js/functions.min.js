/*
 * Project:    RXX - NDB Logging Database
 * Homepage:   https://rxx.classaxe.com
 * Version:    2.8.34
 * Date:       2020-05-24
 * Licence:    LGPL
 * Copyright:  2020 Martin Francis
 */
var highlight,map,gridColor="#808080",gridOpacity=.5,layers={grid:[]},markers=[],all_sections=[],award={},cart=[],popWinSpecs={"countries_*":"width=860,height=630,resizable=1",countries_af:"width=640,height=630,resizable=1",countries_as:"width=780,height=590,resizable=1",countries_eu:"width=680,height=590,resizable=1",countries_na:"width=640,height=220,resizable=1",countries_oc:"width=680,height=500,resizable=1",countries_sa:"width=320,height=600,resizable=1","listeners_[id]":"width=1000,height=760,status=1,scrollbars=1,resizable=1","listeners_[id]_logs":"width=1000,height=760,status=1,scrollbars=1,resizable=1","listeners_[id]_upload":"width=1000,height=760,status=1,scrollbars=1,resizable=1","listeners_[id]_signals":"width=1000,height=760,status=1,scrollbars=1,resizable=1","listeners_[id]_map":"width=1000,height=760,status=1,scrollbars=1,resizable=1","listeners_[id]_locatormap":"width=1000,height=760,status=1,scrollbars=1,resizable=1","[id]_signals_map":"width=1000,height=760,status=1,scrollbars=1,resizable=1","listeners_[id]_ndbweblog":"status=1,scrollbars=1,resizable=1",maps_af:"width=646,height=652,resizable=1",maps_alaska:"width=600,height=620,resizable=1",maps_as:"width=856,height=645,resizable=1",maps_au:"width=511,height=545,resizable=1",maps_eu:"width=704,height=760,resizable=1",maps_japan:"width=517,height=740,resizable=1",maps_na:"width=669,height=720,resizable=1",maps_pacific:"width=600,height=750,resizable=1",maps_polynesia:"width=500,height=525,resizable=1",maps_sa:"width=490,height=745,resizable=1",signals_new:"width=720,height=320,status=1,scrollbars=1,resizable=1","signals_[id]":"width=1040,height=800,status=1,scrollbars=1,resizable=1","signals_[id]_logs":"width=1040,height=800,status=1,scrollbars=1,resizable=1","signals_[id]_listeners":"width=1040,height=800,status=1,scrollbars=1,resizable=1","signals_[id]_map":"width=1040,height=800,status=1,scrollbars=1,resizable=1","signals_[id]_weather":"width=1040,height=800,status=1,scrollbars=1,resizable=1","states_*":"width=720,height=760,resizable=1",states_aus:"width=720,height=240,resizable=1",states_can_usa:"width=680,height=690,resizable=1"},awards={all_sections:[],init:function(e){var t,o;for(t in awards.all_sections=e,awards.all_sections)o=awards.all_sections[t],$("#toggle_"+o).css({cursor:"pointer"}).prop("title",msg.show_hide).click(function(){$("#"+this.id.replace("toggle_","")).toggle(),$(this).find("span").toggle()}).find("span").css({"font-size":"120%"});$("#all_0").click(function(){return awards.toggleSections(0),!1}),$("#all_1").click(function(){return awards.toggleSections(1),!1}),$("#form_email").change(function(){isValidEmail($("#form_email").val())?$("#form_submit").removeAttr("disabled"):$("#form_submit").attr("disabled","disabled")}),$("#form_done").click(function(){location.replace(location.protocol+"//"+location.host+location.pathname)}),$("#form_body").val(msg.cart_none),$(".cart").each(function(){$(this).html('<span><img src="'+base_image+'/icon_cart.gif" alt="'+msg.no+'" title=""/><img style="display: none" src="'+base_image+'/icon_cart_added.gif" alt="'+msg.yes+'" /></span>')}),$(".cart span").click(function(){var e=$(this).parent(),t=e.attr("id");awards.toggleAward(t),e.find("img").toggle()}),$("#form_submit").click(function(){var e=msg.cart_conf_1+"\n"+msg.cart_conf_2+"\n\n"+msg.cart_conf_3+"\n"+msg.cart_conf_4;if(!confirm(e))return alert(msg.cancelled),!1})},toggleAward:function(e){var o,t,i,s;if(-1===(i=$.inArray(e,cart))?cart.push(e):cart.splice(i,1),cart=cart.sort(),s=msg.cart_none,cart.length){for(t in o=[],cart)o.push(cart[t].split("-")[0]);o=$.grep(o,function(e,t){return $.inArray(e,o)===t}),s=msg.cart_1+"\n"+msg.cart_2.padEnd(8," ")+award.admin+"\n"+msg.cart_3.padEnd(8," ")+award.from+"\n"+msg.cart_4.padEnd(8," ")+award.url+"/"+o.join(",")+"\n\n"+msg.cart_5+"\n"+msg.cart_6+"\n\n * "+cart.join("\n * ")+"\n\n"+msg.cart_7+"\n"+award.name}$("#form_awards").val(cart.join(",")),$("#form_filter").val(o.join(",")),$("#form_body").val(s),cart.length&&isValidEmail($("#form_email").val())?$("#form_submit").removeAttr("disabled"):$("#form_submit").attr("disabled","disabled")},toggleSections:function(e){var t,o,i;for(t in awards.all_sections)o=$("#"+awards.all_sections[t]),i=$("#toggle_"+awards.all_sections[t]),e?(o.show(),i.find("span:eq(0)").hide(),i.find("span:eq(1)").show()):(o.hide(),$sectionToggle.find("span:eq(0)").show(),i.find("span:eq(1)").hide())}};function changeShowMode(e){$("#form_show").val(e),formSubmit()}function decodeHtmlEntities(e){return $("<div/>").html(e).text()}function getMetar(e){window.open("https://www.aviationweather.gov/metar/data?ids="+$("#form_icao").val()+"&format="+(e?"decoded":"raw")+"&taf=on&layout=off&hours="+$("#form_hours").val(),"popMETAR"+e,"scrollbars=1,resizable=1,location=1")}function isValidEmail(e){return/^([\w-.]+@([\w-]+\.)+[\w-]{2,4})?$/.test(e)}function popup(e){var t,o,i,s,r,a,n=[];for(a=e.split("/").reverse(),o=0;o<=2;o++)$.isNumeric(a[o])?(i=a[o],n.push("[id]")):n.push(a[o]);return["rna","reu","rww"].includes(n[2])&&n.pop(),n.reverse(),s=n.join("_").replace(",","_").split("?")[0],void 0===popWinSpecs[s]?(alert("Unhandled mode "+s),!1):(r=s.replace("[id]",i),(t=window.open(e,r,popWinSpecs[s]))?t.focus():alert("ERROR:\n\nThis site tried to open a popup window\nbut was prevented from doing so.\n\nPlease disable any popup blockers you may\nhave enabled for this site."),!1)}function scrollToResults(){""!==$("#form_show").val()&&$([document.documentElement,document.body]).animate({scrollTop:$("#tabs").offset().top-20},500)}function setClippedCellTitles(){$("td.clipped").each(function(){$(this).attr("title",$(this).text().trim())})}function setColumnSortActions(){$("table.results thead tr th[id]").each(function(){$(this).click(function(){var e=this.id.split("|")[0],t=this.id.split("|")[1],o=$("#form_order");$(this).hasClass("sorted")&&(t="a"===o.val()?"d":"a"),$("#form_sort").val(e),o.val(t),$('form[name="form"]').submit()})})}function setColumnSortedClass(){$("table.results thead tr th").each(function(){this.id.split("|")[0]===$("#form_sort").val()&&($(this).append("d"===$("#form_order").val()?" &#9662;":" &#9652;"),$(this).addClass("sorted"))})}function setEmailLinks(){$("a[data-contact]").each(function(){var e=$(this).attr("data-contact").split("").reverse().join("").trim().replace("#","@");$(this).attr("href",e),$(this).removeAttr("data-contact")})}function setEqualHeight(e,t){if(!$(e).height())return window.setTimeout(function(){setEqualHeight(e,t)},100);$(t).height($(e).height()),$(t).show(),$(t).height($(e).height())}function setExternalLinks(){$('a[rel="external"]').attr("target","_blank"),$("a[data-popup]").click(function(){if(1===$(this).data("popup"))return popup(this.href);var e=$(this).data("popup").split("|");return window.open(this.href,e[0],e[1]),!1}),$("a[data-append]").click(function(){var t,e,o,i;return t=$(this).find("span").html(),e="itu"===$(this).data("append")?"#form_countries":"#form_states",i=(o=window.opener.$(e)).val().split(" "),-1!==$.inArray(t,i)?i=i.filter(function(e){return e!==t}):i.push(t),o.val(Array.from(new Set(i)).sort().join(" ").trim()),!1}).attr("title",msg.data_append),$("a[data-set]").click(function(){var e,t,o,i;switch(e=$(this).text(),$(this).data("set")){case"khz":t=["#form_khz_1","#form_khz_2"];break;case"itu":t=["#form_countries"];break;case"sp":t=["#form_states"]}for(i in t)(o=$(t[i])).val()===e?o.val(""):o.val(e);return $('form[name="form"]').submit(),!1}).attr("title",msg.data_set),$("a.close").click(function(){$(this).parent().hide()}),$("a[data-gsq]").click(function(){var e="map_"+$(this).data("gsq");return window.open(this.href,e,"scrollbars=1,resizable=1,width=1024,height=800"),!1}).each(function(){$(this).attr("href","./signals/"+$(this).data("gsq")+"/map")}).attr("title",msg.s_map_eu).attr("class","hover"),$("a[data-signal-map-eu]").click(function(){var e="map_"+$(this).data("signal-map-eu");return window.open(this.href,e,"scrollbars=1,resizable=1,width=1040,height=800"),!1}).each(function(){$(this).attr("href","./signals/"+$(this).data("signal-map-eu")+"/map/eu")}).attr("title",msg.s_map_eu).attr("class","hover"),$("a[data-signal-map-na]").click(function(){var e="map_"+$(this).data("signal-map-na");return window.open(this.href,e,"scrollbars=1,resizable=1,width=1040,height=800"),!1}).each(function(){$(this).attr("href","./signals/"+$(this).data("signal-map-na")+"/map/na")}).attr("title",msg.s_map_na).attr("class","hover")}function setFormCollapseSections(){$("#section_loggings legend").click(function(){$(this).parent().find("fieldset").toggle(),$(this).parent().find("fieldset fieldset").toggle(),$(this).find("span").toggle()}),$("#section_customise legend").click(function(){$(this).parent().find("fieldset").toggle(),$(this).parent().find("fieldset fieldset").toggle(),$(this).find("span").toggle()})}function setFormCountryAction(e){(e=void 0===e||e)?$("select#form_country").change(function(){formSubmit()}):$("select#form_country").off("change")}function setFormCountriesLabelLink(){var e=$('label[for="form_countries"]');e.html('<a href="countries/*" data-popup="1">'+e.html()+"</a>")}function setFormStatesLabelLink(){var e=$('label[for="form_states"]');e.html('<a href="states/*" data-popup="1">'+e.html()+"</a>")}function setFormDatePickers(){$.datepicker.setDefaults({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",yearRange:"1980:+0"}),$(".js-datepicker").datepicker({})}function setFormHeardInModDefault(){0===$("fieldset#form_heard_in_mod div :radio:checked").length&&$('fieldset#form_heard_in_mod div :radio[value="any"]').prop("checked",!0)}function setFormListenerInvertDefault(){0===$("fieldset#form_listener_invert div :radio:checked").length&&$("fieldset#form_listener_invert div :radio[value=0]").prop("checked",!0)}function setFormListenerOptionsStyle(){$("#form_listener").children().each(function(){""===$(this).val()?$(this).addClass("all"):". "===$(this).text().substr(0,2)?($(this).text("Â "+$(this).text().substr(1)),$(this).addClass("secondaryQth")):$(this).addClass("primaryQth")})}function setFormPagingActions(){var e=$("#form_filter"),t=$("#form_prev"),o=$("#form_next"),i=$("#form_limit"),r=$("#form_page");i.length&&(i[0].outerHTML='<select id="form_limit" name="form[limit]" required="required">'+getLimitOptions(paging.total,i.val(),paging.limit)+"</select>",i=$("#form_limit")),r.length&&(r[0].outerHTML='<label class="sr-only" for="form_page">Page Control</label>\n<select id="form_page" name="form[page]" style="display:none">'+getPagingOptions(paging.total,i.val(),paging.page)+"</select>",r=$("#form_page"));var s=$("#form_page option");"-1"!==i.val()&&(t.show(),o.show(),r.show()),i.change(function(){var e=$('form[name="form"]'),t=$("#form_limit"),o=$("#form_page option"),i=$("#form_prev"),s=$("#form_next");o.eq(0).prop("selected",!0),r.prop("selectedIndex",0),"-1"!==t.val()?(i.show(),s.show(),r.show(),o.eq(0).prop("text","1-"+t.val()),i.prop("disabled","disabled"),s.prop("disabled","disabled")):(r.hide(),i.hide(),s.hide()),r.prop("selectedIndex",0),e.submit()}),0<paging.page?t.click(function(){var e=$('form[name="form"]'),t=$("#form_page"),o=$("#form_page option"),i=$("#form_prev"),s=$("#form_next");return i.prop("disabled","disabled"),s.prop("disabled","disabled"),o.eq(paging.page-1).prop("selected",!0),t.prop("selectedIndex",paging.page-1),e.submit(),!1}):t.prop("disabled","disabled"),paging.page+1<s.length?o.click(function(){var e=$('form[name="form"]'),t=$("#form_page"),o=$("#form_page option"),i=$("#form_prev"),s=$("#form_next");return i.prop("disabled","disabled"),s.prop("disabled","disabled"),o.eq(paging.page+1).prop("selected",!0),t.prop("selectedIndex",paging.page+1),e.submit(),!1}):o.prop("disabled","disabled"),r.change(function(){var e=$('form[name="form"]'),t=$("#form_prev"),o=$("#form_next");t.prop("disabled","disabled"),o.prop("disabled","disabled"),e.submit()}),e.change(function(){var e=$('form[name="form"]'),t=$("#form_page"),o=$("#form_page option"),i=$("#form_prev"),s=$("#form_next");o.eq(0).prop("selected",!0),t.prop("selectedIndex",0),i.prop("disabled","disabled"),s.prop("disabled","disabled"),e.submit()})}function copyToClipboard(e){var t=$("<textarea>");$("body").append(t),t.val(e).select(),document.execCommand("copy"),t.remove()}function setFormPagingStatus(e,t){$("#form_paging_status").html(e.replace("%s",t.toLocaleString()))}function setFormPersonaliseAction(e){(e=void 0===e||e)?$("#form_personalise").change(function(){var e=$("#form_personalise option:selected").text(),t=(2===e.split("|").length?e.split("|")[1]:"").trim(),o=$("#form_range_gsq");o.val(t),o.trigger("keyup"),$('form[name="form"]').submit()}):$("#form_personalise").off("change")}function setFormOffsetsAction(e){(e=void 0===e||e)?$("#form_offsets").change(function(){formSubmit()}):$("#form_offsets").off("change")}function setFormRangeAction(){var e=$("#form_range_gsq"),t=$("#form_range_min");e.on("keyup",function(){var e=$("#form_range_gsq").val().length<6;$("#form_range_min").attr("disabled",e),$("#form_range_max").attr("disabled",e)}),t.on("keyup",function(){var e=0===$("#form_range_min").val().length&&0===$("#form_range_max").val().length;$("#form_range_units").attr("disabled",e)}),$("#form_dx_max").on("keyup",function(){var e=0===$("#form_range_min").val().length&&0===$("#form_range_max").val().length;$("#form_range_units").attr("disabled",e)}),e.trigger("keyup"),t.trigger("keyup")}function setFormRangeUnitsDefault(){0===$("fieldset#form_range_units div :radio:checked").length&&$("fieldset#form_range_units div :radio[value=km]").prop("checked",!0)}function setFormAdminAction(e){(e=void 0===e||e)?$("select#form_admin_mode").change(function(){formSubmit()}):$("select#form_admin_mode").off("change")}function setFormHasLogsAction(e){(e=void 0===e||e)?$("select#form_has_logs").change(function(){formSubmit()}):$("select#form_has_logs").off("change")}function setFormTimezoneAction(e){(e=void 0===e||e)?$("#form_timezone").on("selectmenuchange",function(){formSubmit()}):$("#form_timezone").off("selectmenuchange")}function setFormHasMapPosAction(e){(e=void 0===e||e)?$("select#form_has_map_pos").change(function(){formSubmit()}):$("select#form_has_map_pos").off("change")}function setFormRegionAction(e){(e=void 0===e||e)?$("select#form_region").change(function(){formSubmit()}):$("select#form_region").off("change")}function setFormRwwFocusAction(e){(e=void 0===e||e)?$("select#form_rww_focus").change(function(){formSubmit()}):$("select#form_rww_focus").off("change")}function setFormResetAction(e){var t=$('button[type="reset"]');switch(e){case"signals":t.click(function(){var e=$("#form_range_gsq"),t=$("#form_range_min");return setFormAdminAction(!1),setFormRegionAction(!1),setFormRwwFocusAction(!1),setFormOffsetsAction(!1),setFormPersonaliseAction(!1),$("#form_show").val(""),$("#form_types div :checkbox").prop("checked",!1),$("#form_types div :checkbox[value=NDB]").prop("checked",!0),$("#form_call").val(""),$("#form_khz_1").val(""),$("#form_khz_2").val(""),$("#form_channels").prop("selectedIndex",0),$("#form_active").prop("selectedIndex",0),$("#form_personalise").prop("selectedIndex",0),$("#form_offsets").prop("selectedIndex",0),$("#form_states").val(""),$("#form_sp_itu_clause").prop("selectedIndex",0),$("#form_countries").val(""),$("#form_region").prop("selectedIndex",0),$("#form_rww_focus").prop("selectedIndex",0),$("#form_gsq").val(""),e.val(""),t.val(""),$("#form_range_max").val(""),$("#form_range_units_0").prop("checked",1),e.trigger("keyup"),t.trigger("keyup"),$("#form_listener").val([]),$("#form_listener_invert_0").prop("checked",1),$("#form_heard_in").val(""),$("#form_heard_in_mod_0").prop("checked",1),$("#form_logged_date_1").val(""),$("#form_logged_date_2").val(""),$("#form_logged_first_1").val(""),$("#form_logged_first_2").val(""),$("#form_logged_last_1").val(""),$("#form_logged_last_2").val(""),$("#form_admin_mode").prop("selectedIndex",0),setFormPersonaliseAction(!0),setFormOffsetsAction(!0),setFormAdminAction(!0),setFormRegionAction(!0),setFormRwwFocusAction(!0),formSubmit(),!1});break;case"listeners":t.click(function(){return $("fieldset#form_types div :checkbox").prop("checked",!1),$("fieldset#form_types div :checkbox[value=NDB]").prop("checked",!0),$("#form_filter").val(""),setFormCountryAction(!1),setFormRegionAction(!1),setFormRwwFocusAction(!1),setFormHasLogsAction(!1),setFormHasMapPosAction(!1),setFormTimezoneAction(!1),$("select#form_region").prop("selectedIndex",0),$("select#form_country").prop("selectedIndex",0),$("select#form_has_map_pos").prop("selectedIndex",0),$("select#form_timezone").val("").selectmenu("refresh"),setFormCountryAction(!0),setFormRegionAction(!0),setFormRwwFocusAction(!0),setFormHasLogsAction(!0),setFormHasMapPosAction(!0),setFormTimezoneAction(!0),formSubmit(),!1})}}function formSubmit(){$("#form_clear").prop("disabled","disabled"),$("#form_submit").click().prop("disabled","disabled")}function setFormShowModeAction(){$("#seeklist_paper").change(function(){$("#form_paper").val($("#seeklist_paper option:selected").val()),formSubmit()})}function setFormSortbyAction(){$("select#form_sortby").change(function(){var e=$("#form_sortby option:selected").val();$("#form_sort").val(e.split("|")[0]),$("#form_order").val(e.split("|")[1]),$("#form_za").prop("checked","d"===e.split("|")[1]),formSubmit()})}function setFormSortZaAction(){$("input#form_za").change(function(){$("#form_order").val($("input#form_za").prop("checked")?"d":"a"),formSubmit()})}function setFormTypesStyles(){$("fieldset#form_type div input").each(function(){$(this).parent().attr("class","type_"+$(this).attr("class"))})}function setFormTypesDefault(){0===$("fieldset#form_type div :checkbox:checked").length&&$("fieldset#form_type div :checkbox[value=NDB]").prop("checked",!0)}function setFormTypesAllAction(){$("fieldset#form_type div :checkbox[value=ALL]").click(function(){$("fieldset#form_type div :checkbox").prop("checked",$(this).prop("checked"))})}function setFocusOnCall(){$("#form_call").focus()}function strip_tags(e,o){return o=(((o||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join(""),e.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(e,t){return-1<o.indexOf("<"+t.toLowerCase()+">")?e:""})}function initListenersLogUploadForm(){var t=$("#form_format");t.on("keyup",function(){$("#form_saveFormat").attr("disabled",$(this).val()===$("#formatOld").text())}),window.performance&&window.performance.navigation.type===window.performance.navigation.TYPE_BACK_FORWARD&&t.trigger("keyup"),$("#form_saveFormat").on("click",function(){!1!==confirm(msg.log_upload_1)?$("#form_step").val("1b"):e.preventDefault()}),$("#form_tabs2spaces").on("click",function(){var e=$("#form_logs");e.val(e.val().replace(/\t/g,"     "))}),$("#form_lineUp").on("click",function(){var e,t,o,i,s,r,a,n,l,c;for(t in format=$("#form_format"),r=0,l=[],i=(s=$("#form_logs")).val().split("\n"))r<(c=(o=i[t].replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")).split(" ").length)&&(r=c),i[t]=o;for(e=0;e<r;e++)l[e]=0;for(t in i)for(n in c=(o=i[t]).split(" "))(a=c[n]).length>l[n]&&(l[n]=a.length);for(t in i){for(n in c=(o=i[t]).split(" "))a=c[n],c[n]=a.padEnd(l[n]+1," ");i[t]=c.join("")}s.val(i.join("\r\n"))}),$("#form_parseLog").on("click",function(e){var t,o,i;for(t in i=[["#form_format",3,4],["#form_logs",5,6],["#form_YYYY",7,8],["#form_MM",9,10],["#form_DD",11,12]],logsRemoveBlankLines($("#form_logs")),i)if((o=$(i[t][0])).is(":visible")&&(""===o.val()||o.val()===msg["log_upload_"+i[t][2]]))return e.preventDefault(),o.val(msg["log_upload_"+i[t][2]]),alert(msg.error.toUpperCase()+"\n\n"+msg["log_upload_"+i[t][1]]),o.focus().select(),!1;$("#form_selected").val("UNSET"),$("#form_step").val(2)}),$("#form_back").on("click",function(){$("#form_step").val(1),$("#form_selected").val("UNSET")}),$(document).on("click",".tokensHelpLink",function(){return $(this).addClass("on"),$(this).tooltip({content:$("#tokensHelp").html(),items:".tokensHelpLink.on",position:{my:"left+15 top-20",at:"right center"},tooltipClass:"toolTipDetails"}),$(this).trigger("mouseenter"),$(".tokensHelp b").on("click",function(){var e=$(this).text();copyToClipboard(e),alert(msg.copied_x.replace("%s",e))}).attr("title",msg.copy_token),!1}),$(document).on("click",".tokensHelpLink.on",function(){return $(this).removeClass("on"),$(this).tooltip("close"),!1}),$(".tokensHelpLink").on("mouseout",function(e){e.stopImmediatePropagation()}),$("table.parse").on("click","tr td:gt(1)",function(e){e.stopImmediatePropagation();var t=$(this).parent().find("input:checkbox");t.prop("checked",!t.prop("checked")),t.trigger("change")}),$("table.parse input:checkbox").change(function(){$('input[data-idx="'+$(this).data().idx+'"]').not(this).prop("checked",!1),logsShowRemainder()}),$("#form_submitLog").on("click",function(e){var t=msg.log_upload.confirm,o=$("#remainder_logs").val(),i=""===o?0:o.split("\n").length,s=o.trim()?t[1]+"\n"+t[2].replace("COUNT",i)+"\n\n"+t[3]:t[1];if(!confirm(s))return e.preventDefault(),!1;$("#form_step").val(3)}),$("#copyRemainder").on("click",function(){return copyToClipboard($("#remainder_logs").val()),alert(msg.log_upload.copy_remaining),!1}),$(".jump .up").on("click",function(){var e=parseInt($(this).parent().attr("id").split("_")[1]),t=$("#jump_"+(e-1)).parent().attr("id").split("_")[1];document.getElementById("row_"+(t-1)).scrollIntoView({behavior:"smooth",block:"start"})}),$(".jump .down").on("click",function(){var e=parseInt($(this).parent().attr("id").split("_")[1]);if($("#jump_"+(e+1)).length){var t=$("#jump_"+(e+1)).parent().attr("id").split("_")[1];document.getElementById("row_"+(t-1)).scrollIntoView({behavior:"smooth",block:"start"})}else alert(msg.log_upload.last_item)})}function logsRemoveBlankLines(e){var t,o,i;for(o=e.val().split("\n"),i=[],t=0;t<o.length;t++)""!==o[t].trim()&&i.push(o[t]);e.val(i.join("\n"))}function logsShowRemainder(){var e,t,o=$("#form_logs").val().split("\n"),i=[],s=[],r=[];for(e in $("table.parse input:checkbox").each(function(){$(this).is(":checked")&&(s.push($(this).val()),t=$(this).val().split("|")[0],i[t]=t)}),i)i.hasOwnProperty(e)&&(o[e]="");for(e in o)o.hasOwnProperty(e)&&""!==o[e]&&r.push(o[e]);$("#remainder_format").val($("#form_format").val()),$("#remainder_logs").val(r.join("\r\n")),$("#form_selected").val(s.join(",")),$("#issueCount").text(r.length)}var LMap={markerGroups:null,init:function(){map=new google.maps.Map($("#map").get(0),{center:{lat:center.lat,lng:center.lon},scaleControl:!0,zoomControl:!0,zoom:7}),box[0].lat===box[1].lat&&box[0].lon===box[1].lon||map.fitBounds(new google.maps.LatLngBounds(new google.maps.LatLng(box[0].lat,box[0].lon),new google.maps.LatLng(box[1].lat,box[1].lon))),LMap.drawGrid(),LMap.drawMarkers(),LMap.setActions(),setExternalLinks(),setClippedCellTitles()},drawGrid:function(){return drawGrid(map,layers)},drawMarkers:function(){var e,t,o,i,s,r;if(listeners){for(t in LMap.markerGroups=new google.maps.MVCObject,LMap.markerGroups.set("primary",map),LMap.markerGroups.set("secondary",map),LMap.markerGroups.set("highlight",map),i={url:base_image+"/map_point3.gif",origin:new google.maps.Point(0,0),anchor:new google.maps.Point(5,5)},s={url:base_image+"/map_point4.gif",origin:new google.maps.Point(0,0),anchor:new google.maps.Point(5,5)},o={url:base_image+"/map_point_here.gif",origin:new google.maps.Point(0,0),anchor:new google.maps.Point(6,6)},e="",listeners)l=listeners[t],e+='<tr id="listener_'+l.id+'" class="qth_'+(l.pri?"pri":"sec")+'" data-gmap="'+l.lat+"|"+l.lon+'"><td class="text-nowrap"><img style="display:block;float: left" src="'+base_image+"/map_point"+(l.pri?3:4)+'.gif" alt="'+(l.pri?msg.qth_pri:msg.qth_sec)+'" /><a href="'+base_url+"listeners/"+l.id+'" class="'+(l.pri?"pri":"sec")+'" data-popup="1">'+l.name+"</a></td><td>"+l.qth+"</td><td>"+l.sp+"</td><td>"+l.itu+"</td></tr>",(r=new google.maps.Marker({id:"point_"+l.id,icon:l.pri?i:s,position:new google.maps.LatLng(l.lat,l.lon),title:decodeHtmlEntities(l.name)+": "+decodeHtmlEntities(l.qth)+(l.sp?", "+l.sp:"")+", "+l.itu})).bindTo("map",LMap.markerGroups,l.pri?"primary":"secondary"),markers.push(r);for(t in markers)markers[t].addListener("mouseover",function(){$("#listener_"+this.id.split("_")[1]).css("background","#ffff00")}),markers[t].addListener("mouseout",function(){$("#listener_"+this.id.split("_")[1]).css("background","")}),markers[t].addListener("click",function(){$("#listener_"+this.id.split("_")[1]).find("a").trigger("click")});$(".results tbody").append(e),$("tr[data-gmap]").mouseover(function(){var e=$(this).data("gmap").split("|");highlight=new google.maps.Marker({position:new google.maps.LatLng(e[0],e[1]),map:map,icon:o})}).mouseout(function(){highlight.setMap(null)}),$(".no-results").hide(),$(".results").show()}},setActions:function(){$("#layer_grid").click(function(){var e,t;for(t in e=$("#layer_grid").prop("checked"),layers.grid)layers.grid[t].setMap(e?map:null)}),$("#layer_primary").click(function(){var e=$("#layer_primary");LMap.markerGroups.set("primary",e.prop("checked")?map:null),e.prop("checked")?$("#markerlist .qth_pri").show():$("#markerlist .qth_pri").hide()}),$("#layer_secondary").click(function(){var e=$("#layer_secondary");LMap.markerGroups.set("secondary",e.prop("checked")?map:null),e.prop("checked")?$("#markerlist .qth_sec").show():$("#markerlist .qth_sec").hide()})}};function initListenersForm(e,t){$(document).ready(function(){setFormPagingActions(),setFormTypesStyles(),setFormTypesDefault(),$("#form_timezone").selectmenu(),setFormTypesAllAction(),setFormCountryAction(),setFormRegionAction(),setFormHasLogsAction(),setFormHasLogsAction(),setFormHasMapPosAction(),setFormTimezoneAction(),setFormResetAction("listeners"),setColumnSortActions(),setColumnSortedClass(),setExternalLinks(),setFormPagingStatus(e,t),setListenerActions(),scrollToResults(),RT.init($("#wide"),$("#narrow"))})}function setListenerActions(){$("#btn_prt").click(function(){return window.print(),!1}),$("#btn_share").click(function(){return shareListeners(),!1}),$("#btn_new").click(function(){return window.open("./listeners/new","listener_new",popWinSpecs["listeners_[id]"]),!1})}var LocatorMap={init:function(t,o){var i=$("#rx_map");if(!i.height())return window.setTimeout(function(){LocatorMap.init(t,o)},100);i.on("click",function(){var t=parseInt(e.pageX-$(this).offset().left),o=parseInt(e.pageY-$(this).offset().top);LocatorMap.setPos(t,o),$("#form_mapX").val(t),$("#form_mapY").val(o)}),$("#form_mapX").change(function(){t=parseInt($("#form_mapX").val()),o=parseInt($("#form_mapY").val()),LocatorMap.setPos(t,o)}),$("#form_mapY").change(function(){t=parseInt($("#form_mapX").val()),o=parseInt($("#form_mapY").val()),LocatorMap.setPos(t,o)}),$("#x_sub").click(function(){var e=$("#form_mapX"),t=parseInt(e.val());0<t&&e.val(t-1).trigger("change")}),$("#x_add").click(function(){var e=$("#form_mapX"),t=parseInt(e.val());e.val(t+1).trigger("change")}),$("#y_sub").click(function(){var e=$("#form_mapY"),t=parseInt(e.val());0<t&&e.val(t-1).trigger("change")}),$("#y_add").click(function(){var e=$("#form_mapY"),t=parseInt(e.val());e.val(t+1).trigger("change")}),$("#form_reset").click(function(e){e.preventDefault(),form=e.toElement.form,form.reset(),t=$("#form_mapX").val(),o=$("#form_mapY").val(),LocatorMap.setPos(t,o)}),LocatorMap.setPos(t,o),$("#form").show()},setPos:function(e,t){0===e&&0===t||$("#cursor").css({left:e-10+"px",top:t-10+"px",display:"block"})}};function drawGrid(e,t){var o,i,s;for(TxtOverlay=initMapsTxtOverlay(),i=0;i<180;i+=10)t.grid.push(new google.maps.Polyline({path:[{lat:i-90,lng:-180},{lat:i-90,lng:0},{lat:i-90,lng:180}],geodesic:!1,strokeColor:gridColor,strokeOpacity:gridOpacity,strokeWeight:.5}));for(s=0;s<360;s+=20)t.grid.push(new google.maps.Polyline({path:[{lat:85.05,lng:s},{lat:-85.05,lng:s}],geodesic:!1,strokeColor:gridColor,strokeOpacity:gridOpacity,strokeWeight:.5}));for(i=10;i<170;i+=10)for(s=0;s<360;s+=20)t.grid.push(new TxtOverlay(new google.maps.LatLng(i-90+5,s-180+10),String.fromCharCode(s/20+65)+String.fromCharCode(i/10+65),"gridLabel",e));for(o in t.grid)t.grid[o].setMap(e)}function initMapsTxtOverlay(){function e(e,t,o,i){this.pos=e,this.txt_=t,this.cls_=o,this.map_=i,this.div_=null,this.setMap(i)}return(e.prototype=new google.maps.OverlayView).onAdd=function(){var e,t;(e=document.createElement("DIV")).className=this.cls_,e.innerHTML=this.txt_,this.div_=e,t=this.getProjection().fromLatLngToDivPixel(this.pos),e.style.left=t.x+"px",e.style.top=t.y+"px",this.getPanes().floatPane.appendChild(e)},e.prototype.draw=function(){var e,t;t=this.getProjection().fromLatLngToDivPixel(this.pos),(e=this.div_).style.left=t.x+"px",e.style.top=t.y+"px"},e.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null},e}function getLimitOptions(e,t,o){var i=[10,20,50,100,200,500,1e3,2e3,5e3,1e5,2e4,5e4,1e5],s="";for(var r in i)e<i[r]&&o<i[r]||(s+='<option value="'+i[r]+'"'+(parseInt(t)===i[r]?' selected="selected"':"")+">"+i[r]+" results</option>");return s+='<option value="'+(i[0]<e?-1:o)+'"'+(-1===parseInt(t)?' selected="selected"':"")+">All results</option>"}function getPagingOptions(e,t,o){var i="";pages=e/t;for(var s=0;s<pages;s++)i+='<option value="'+s+'"'+(parseInt(o)===s?' selected="selected"':"")+">"+(1+s*t)+"-"+(e<(s+1)*t?e:(s+1)*t)+"</option>";return i}var RT={classes:[],fields:[],preamble:"",rows:[],titles:[],init:function(e,t){this.source=e,this.destination=t,this.readSource(),this.drawMedium(),this.drawNarrow()},drawMedium:function(){var i,s=0;for(i in RT.fields)RT.fields[i].rowspan2?RT.preamble+="th"===RT.fields[i].type?"<th></th>":"<td></td>":s++;i=0,this.source.find("tbody tr").each(function(){var e,t,o=$(this);for(j in t="<table>",RT.fields)RT.rows[i][RT.fields[j].idx].l2&&RT.rows[i][RT.fields[j].idx].html&&(e=RT.rows[i][RT.fields[j].idx].class.replace(/( )*l2/gi,""),t+="<tr><th>"+RT.fields[j].html+':</th><td class="'+e+'">'+RT.rows[i][RT.fields[j].idx].html+"</td></tr>");t+="</table>",o.after('<tr class="'+o.prop("class")+' l2_alt">'+RT.preamble+'<td colspan="'+s+'">'+t+"</td></tr>"),i++})},drawNarrow:function(){var e,t,o;for(t in e="",this.rows){for(o in e+='<table class="responsive"><tbody>\n',this.fields)""!==this.rows[t][this.fields[o].idx].html&&(e+='<tr title="'+this.titles[t]+'"><th>'+this.fields[o].html+'</th><td class="'+this.rows[t][this.fields[o].idx].class+'">'+this.rows[t][this.fields[o].idx].html+"</td></tr>\n");e+="</tbody></table>\n\n"}this.destination.append(e)},readSource:function(){var t=0;this.source.find("thead tr th").each(function(){var e=$(this);RT.fields.push({idx:t++,html:e.html().trim().split("<br>")[0],l2:e.hasClass("l2"),rowspan2:e.hasClass("rowspan2"),type:e.hasClass("th")?"th":"td"}),RT.classes.push(e.prop("title").trim()),RT.titles.push(e.prop("title").trim())}),this.source.find("tbody tr").each(function(){var e=$(this),t={title:e.prop("title")},o=0;e.find("th,td").each(function(){var e=$(this);t[RT.fields[o++].idx]={class:e.prop("class"),l2:e.hasClass("l2"),html:e.html().trim()}}),RT.rows.push(t)})}},shareableLink={getBaseUrl:function(e){return base_host+base_url+e},getFromField:function(e,t,o){var i=$("#form_"+e).val();return void 0===i||""===i?"":("string"==typeof o&&-1!==$.inArray(o,["a","A"])&&(i="a"===o?i.toLowerCase():i.toUpperCase()),void 0===t||-1!==$.inArray(i,t)?"&"+e+"="+encodeURI(i):"")},getFromListeners:function(){var e=$("#form_listener");return void 0===e.val()||""===encodeURI(e.val())?"":"&listeners="+encodeURI(e.val())},getFromPagingControls:function(e){var t=$("#form_limit"),o=$("#form_page");return(e!==parseInt(t.val())?"&limit="+t.val():"")+(void 0!==o.val()&&0!==parseInt(o.val())?"&page="+o.val():"")},getFromPair:function(e){var t=$("#form_"+e+"_1"),o=$("#form_"+e+"_2");return t.val()||o.val()?"&"+e+"="+encodeURI(t.val())+(t.val()!==o.val()?","+encodeURI(o.val()):""):""},getFromRadioGroup:function(e,t){var o=$("input[name='form["+e+"]']:checked");return void 0!==o.val()&&""!==o.val()&&(void 0===t||-1!==$.inArray(o.val(),t))?"&"+e+"="+encodeURI(o.val()):""},getFromSortingControls:function(e,t){var o=$("#form_sort"),i=$("#form_order");return(e!==o.val()?"&sort="+o.val():"")+(t!==i.val()?"&order="+i.val():"")},getFromTypes:function(){var e=[];return $("fieldset#form_type div input").each(function(){$(this).is(":checked")&&"ALL"!==$(this).prop("value")&&e.push($(this).prop("value")),0===e.length&&(e=["NDB"]),7===e.length&&(e=["ALL"])}),"?types="+$.uniqueSort(e).join(",")},listenersUrl:function(){return this.getBaseUrl("listeners")+this.getFromTypes()+this.getFromField("q")+this.getFromField("region")+this.getFromField("country")+this.getFromField("has_logs",["N","Y"],"A")+this.getFromField("has_map_pos",["N","Y"],"A")+this.getFromField("timezone")+this.getFromPagingControls(100)+this.getFromSortingControls("name","a")},signalsUrl:function(){return this.getBaseUrl("signals")+this.getFromTypes()+this.getFromField("rww_focus")+this.getFromField("call")+this.getFromPair("khz")+this.getFromField("channels")+this.getFromField("states")+this.getFromField("sp_itu_clause",["or"])+this.getFromField("countries")+this.getFromField("region")+this.getFromField("gsq")+this.getFromField("active")+this.getFromListeners()+this.getFromRadioGroup("listener_invert",["1"])+this.getFromField("heard_in")+this.getFromRadioGroup("heard_in_mod",["all"])+this.getFromPair("logged_date")+this.getFromPair("logged_first")+this.getFromPair("logged_last")+this.getFromPagingControls(50)+this.getFromSortingControls("khz","a")+this.getFromField("personalise")+this.getFromField("offsets",["1"])+this.getFromField("range_gsq")+this.getFromField("range_min")+this.getFromField("range_max")+(this.getFromField("range_gsq")?this.getFromRadioGroup("range_units"):"")+this.getFromRadioGroup("paper",["a4","a4_l","lgl","lgl_l","ltr","ltr_l"])}};function shareListeners(){var e=shareableLink.listenersUrl();$("#dialog").html("<p>"+msg.share.listeners.text1+"<br>"+msg.share.listeners.text2+'</p><ul><li><a style="color:#0000ff" href="'+e+'&show=list">'+msg.share.listeners.links.list+'</a></li><li><a style="color:#0000ff" href="'+e+'&show=map">'+msg.share.listeners.links.map+"</a></li></ul>").dialog({buttons:[{text:msg.close,click:function(){$(this).dialog("close")}}],open:function(){$(".ui-dialog-buttonpane button").focus()},modal:!0,title:msg.share.listeners.title})}function shareSignals(){var e=shareableLink.signalsUrl();$("#dialog").html("<p>"+msg.share.signals.text1+"<br>"+msg.share.signals.text2+'</p><ul><li><a style="color:#0000ff" href="'+e+'&show=list">'+msg.share.signals.links.list+'</a></li><li><a style="color:#0000ff" href="'+e+'&show=seeklist">'+msg.share.signals.links.seeklist+'</a></li><li><a style="color:#0000ff" href="'+e+'&show=map">'+msg.share.signals.links.map+'</a></li><li><a style="color:#0000ff" href="'+e+'&show=csv">'+msg.share.signals.links.export+"</a></li></ul>").dialog({buttons:[{text:msg.close,click:function(){$(this).dialog("close")}}],open:function(){$(".ui-dialog-buttonpane button").focus()},modal:!0,title:msg.share.signals.title})}var SLMap={init:function(){var e,t,o="",i="";for(e in listeners)o+='<tr id="listener_'+(t=listeners[e]).id+'" data-map="'+t.x+"|"+t.y+"|"+t.id+'"'+(t.dt?' title="'+msg.daytime+'"':"")+'>\n<td>\n<img src="'+base_image+"/map_point"+(t.pri?1:2)+'.gif" alt="'+(t.pri?msg.qth_pri:msg.qth_sec)+'" />\n<a href="'+base_url+"listeners/"+t.id+'" class="'+(t.pri?"pri":"sec")+'">'+t.name+"</a>\n</td>\n<td>"+t.sp+"</td>\n<td>"+t.itu+"</td>\n<td>"+(t.dt?"<b>"+t.km+"</b>":t.km)+"</td>\n<td>"+(t.dt?"<b>"+t.mi+"</b>":t.mi)+"</td>\n</tr>\n",i+='<area alt="'+t.name+'" title="'+t.name+'" shape="circle" href="'+base_url+"listeners/"+t.id+'" coords="'+t.x+","+t.y+',4" data-map="'+t.id+'" />\n';$(".results tbody").html(o),$("#imgmap").html(i),SLMap.setActions()},setActions:function(){$("area[data-map]").mouseover(function(){$("#listener_"+$(this).data("map")).css({backgroundColor:"#ffff00"}).trigger("mouseenter")}).mouseout(function(){$("#listener_"+$(this).data("map")).css({backgroundColor:""}).trigger("mouseleave")}),$("tr[data-map]").mouseover(function(){var t=$(this).data("map").split("|"),e=$("#rx_map"),o=e.width()/e[0].naturalWidth;$("#point_here").show().css({left:t[0]*o-5+"px",top:t[1]*o-5+"px"}).unbind().click(function(e){return e.preventDefault(),$("#listener_"+t[2]+" a").trigger("click"),!1})}).mouseout(function(){$("#point_here").hide()}),$("tr[data-map] a").click(function(){var e="listeners_"+$(this).data("map");return window.open(this.href,e,popWinSpecs["listeners_[id]"]),!1})}},SMap={map:null,icons:{},infoWindow:null,markers:[],options:{},init:function(){var e=["dgps","dsc","hambcn","navtex","ndb","time","other"],t=[0,1];for(var o in e)for(var i in t){var s=base_image+"/pins/"+e[o]+"_"+t[i]+".png";SMap.icons[e[o]+"_"+t[i]]=new google.maps.MarkerImage(s,new google.maps.Size(12,20))}SMap.options={zoom:7,center:new google.maps.LatLng(center.lat,center.lon),mapTypeId:google.maps.MapTypeId.ROADMAP},SMap.map=new google.maps.Map($("#map").get(0),SMap.options),box[0].lat===box[1].lat&&box[0].lon===box[1].lon||SMap.map.fitBounds(new google.maps.LatLngBounds(new google.maps.LatLng(box[0].lat,box[0].lon),new google.maps.LatLng(box[1].lat,box[1].lon))),SMap.infoWindow=new google.maps.InfoWindow,SMap.drawGrid(),SMap.drawMarkers(),SMap.drawQTH(),SMap.setActions(),setExternalLinks(),setClippedCellTitles()},drawGrid:function(){return drawGrid(SMap.map,layers)},drawMarkers:function(){var e,t,o,i,r;if(signals){for(t in r="undefined"==typeof listener?"S":"LS",SMap.markerGroups=new google.maps.MVCObject,types)SMap.markerGroups.set("type_"+types[t]+"_0",SMap.map),SMap.markerGroups.set("type_"+types[t]+"_1",SMap.map);for(t in SMap.markerGroups.set("highlight",SMap.map),o={url:base_image+"/map_point_here.gif",origin:new google.maps.Point(0,0),anchor:new google.maps.Point(6,7)},e="",signals)s=signals[t],e+='<tr class="type_'+s.typeId+" type_"+s.className+(void 0!==s.logged?s.logged?" logged":" unlogged":"")+'" id="signal_'+s.id+'" data-gmap="'+s.lat+"|"+s.lon+'">'+(void 0!==s.logged?"<th>"+(s.logged?"&#x2714;":"&nbsp;")+"</th>":"")+"<td>"+s.khz+'</td><td class="text-nowrap"><a href="'+base_url+"signals/"+s.id+'" class="'+(s.active?"":"inactive")+'" data-popup="1">'+s.call+'</a></td><td class="clipped">'+s.qth+"</td><td>"+s.sp+"</td><td>"+s.itu+"</td>"+("LS"==r?'<td class="num">'+s.km+"</td>":"")+("LS"==r?'<td class="num">'+s.mi+"</td>":"")+"</tr>",i=new google.maps.Marker({id:"point_"+s.id,icon:SMap.icons[s.icon+"_"+(s.active?1:0)],position:new google.maps.LatLng(s.lat,s.lon),title:strip_tags(s.khz+" "+s.call)}),google.maps.event.addListener(i,"click",SMap.markerClickFunction(s)),i.bindTo("map",SMap.markerGroups,"type_"+s.typeId+"_"+(s.active?"1":"0")),markers.push(i);$(".results tbody").append(e),$("tr[data-gmap]").mouseover(function(){var e=$(this).data("gmap").split("|");highlight=new google.maps.Marker({position:new google.maps.LatLng(e[0],e[1]),map:SMap.map,icon:o})}).mouseout(function(){highlight.setMap(null)}),$(".no-results").hide(),$(".results").show()}},drawQTH:function(){"undefined"!=typeof listener&&(layers.qth=new google.maps.Marker({position:{lat:listener.lat,lng:listener.lng},map:SMap.map,icon:{scaledSize:new google.maps.Size(30,30),url:"//maps.google.com/mapfiles/kml/pushpin/red-pushpin.png"},title:listener.name,zIndex:100}),qthInfo=new google.maps.InfoWindow({content:"<h2>"+listener.name+"</h2><p>"+listener.qth+"</p>"}),layers.qth.addListener("click",function(){qthInfo.open(SMap.map,layers.qth)}))},markerClickFunction:function(o){return function(e){e.cancelBubble=!0,e.returnValue=!1,e.stopPropagation&&(e.stopPropagation(),e.preventDefault());var t='<div class="map_info">  <h3><a href="'+base_url+"signals/"+o.id+'" onclick="return popup(this.href);">'+o.khz+" "+o.call+'</a></h3>  <table class="info-body">'+(void 0!==o.logged?"    <tr><th>"+msg.logged+"</th><td>"+(o.logged?msg.yes:msg.no)+"</td></tr>":"")+"    <tr><th>"+msg.id+"</th><td>"+o.call+"</td></tr>    <tr><th>"+msg.khz+"</th><td>"+o.khz+"</td></tr>    <tr><th>"+msg.type+"</th><td>"+o.type+"</td></tr>"+("0"!==o.pwr?"    <tr><th>"+msg.power+"</th><td>"+o.pwr+"W</td></tr>":"")+"    <tr><th>"+msg.name_qth+"</th><td>"+o.qth+(o.sp?", "+o.sp:"")+", "+o.itu+"</td></tr>"+(o.gsq?"    <tr><th>"+msg.gsq+'</th><td><a href="'+base_url+"signals/"+o.id+'/map" onclick="return popup(this.href);" title="Show map (accuracy limited to nearest Grid Square)">'+o.gsq+"</a></td></tr>":"")+"    <tr><th>"+msg.lat_lon+"</th><td>"+o.lat+", "+o.lon+"</td></tr>"+(o.usb||o.lsb?"    <tr><th>"+msg.sidebands+"</th><td>"+(o.lsb?"LSB: "+o.lsb:"")+(o.usb?(o.lsb?", ":"")+" USB: "+o.usb:"")+"</td></tr>":"")+(o.sec||o.fmt?"    <tr><th>"+msg.sec_format+"</th><td>"+(o.sec?o.sec+" sec":"")+(o.sec&&o.fmt?", ":"")+o.fmt+"</td></tr>":"")+"    <tr><th>"+msg.last_logged+"</th><td>"+o.heard+"</td></tr>    <tr><th>"+msg.heard_in+"</th><td>"+o.heard_in+"</td></tr>  </table></div>";SMap.infoWindow.setContent(t),SMap.infoWindow.setPosition(new google.maps.LatLng(o.lat,o.lon)),SMap.infoWindow.open(SMap.map)}},setActions:function(){$("#layer_grid").click(function(){var e,t;for(t in e=$("#layer_grid").prop("checked"),layers.grid)layers.grid[t].setMap(e?SMap.map:null)}),$("#layer_qth").click(function(){layers.qth.setMap($("#layer_qth").prop("checked")?SMap.map:null)}),$("#layer_active").click(function(){var e,t,o,i;for(e in types)i=types[e],t=$("#layer_active"),o=$("#layer_"+i),SMap.markerGroups.set("type_"+i+"_1",t.prop("checked")&&o.prop("checked")?SMap.map:null),o.prop("checked")&&t.prop("checked")?$(".results tbody .type_"+i+".active").show():$(".results tbody .type_"+i+".active").hide()}),$("#layer_inactive").click(function(){var e,t,o,i;for(e in types)i=types[e],t=$("#layer_inactive"),o=$("#layer_"+i),SMap.markerGroups.set("type_"+i+"_0",t.prop("checked")&&o.prop("checked")?SMap.map:null),o.prop("checked")&&t.prop("checked")?$(".results tbody .type_"+i+".inactive").show():$(".results tbody .type_"+i+".inactive").hide()}),types.forEach(function(t){$("#layer_"+t).click(function(){var e=$("#layer_"+t);SMap.markerGroups.set("type_"+t+"_0",$("#layer_inactive").prop("checked")&&e.prop("checked")?SMap.map:null),SMap.markerGroups.set("type_"+t+"_1",$("#layer_active").prop("checked")&&e.prop("checked")?SMap.map:null),e.prop("checked")?($("#layer_inactive").prop("checked")?$(".results tbody .type_"+t+".inactive").show():$(".results tbody .type_"+t+".inactive").hide(),$("#layer_active").prop("checked")?$(".results tbody .type_"+t+".active").show():$(".results tbody .type_"+t+".active").hide()):$(".results tbody .type_"+t).hide()})})}};function initSignalsForm(e,t){$(document).ready(function(){setFormPagingActions(),setFormPersonaliseAction(),setFormOffsetsAction(),setFormRangeAction(),setFormRangeUnitsDefault(),setFormSortbyAction(),setFormSortZaAction(),setFormShowModeAction(),setFormTypesStyles(),setFormTypesDefault(),setFormTypesAllAction(),setFormCountryAction(),setFormAdminAction(),setFormRegionAction(),setFormRwwFocusAction(),setFormStatesLabelLink(),setFormCountriesLabelLink(),setFormListenerInvertDefault(),setFormHeardInModDefault(),setFormListenerOptionsStyle(),setFormDatePickers(),setFormCollapseSections(),setFormResetAction("signals"),setColumnSortActions(),setColumnSortedClass(),setExternalLinks(),setFormPagingStatus(e,t),setSignalActions(),scrollToResults(),setFocusOnCall(),RT.init($("#wide"),$("#narrow"))})}function setSignalActions(){$("#btn_csv_all").click(function(){window.location.assign(window.location+"/export/csv")}),$("#btn_txt_all").click(function(){window.location.assign(window.location+"/export/txt")}),$("#btn_csv_fil").click(function(){var e=$("#form_show"),t=e.val();e.val("csv"),$("#form_submit").click(),e.val(t)}),$("#btn_txt_fil").click(function(){var e=$("#form_show"),t=e.val();e.val("txt"),$("#form_submit").click(),e.val(t)}),$("#btn_prt").click(function(){return window.print(),!1}),$("#btn_share").click(function(){return shareSignals(),!1}),$("#btn_new").click(function(){return window.open("./signals/new","signal_new",popWinSpecs["signals_[id]"]),!1})}