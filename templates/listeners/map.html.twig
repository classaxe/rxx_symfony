{% include 'js_trans.html.twig' %}
<script>
//<!--
var box = [{ lat: {{ box[0][0] }}, lon: {{ box[0][1] }}}, { lat: {{ box[1][0] }}, lon: {{ box[1][1] }} }];
var center = { lat: {{ center[0] }}, lon: {{ center[1] }} };
var listeners = [
{% for row in listeners %}{'id':"{{
    row.id }}", 'name':"{{
    row.name|raw }}", 'pri':{{
    row.primaryQth ? 1 : 0 }}, 'qth':"{{
    row.qth|raw }}", 'itu':"{{
    row.itu }}", 'sp':"{{
    row.sp }}", 'lat':{{
    row.lat }}, 'lon':{{
    row.lon }}, 'gsq':"{{
    row.gsq }}"},
{% endfor %}
];

$(document).ready( function() {
    $('#map').height($(window).height() - 120);
    $('.scroll div').height($('#map').height());
    $(window).resize(function () {
        $('#map').height($(window).height() - 120);
        $('.scroll div').height($('#map').height());
    });
});
// -->
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCmvsfY0bgnVB-gl_nMHGQ71rp1WTz9tGM&callback=initListenersMap"></script>
<table class="map_layout">
    <tbody>
    <tr>
        <td width="30%">
            <h2>{{ system|upper }} {% trans %}Listeners Map{% endtrans %}</h2>
            <div class="scroll">
                <div>
                <table class="results" id="markerlist" style="display:none; margin: 0; max-width: 500px">
                    <thead>
                    <tr>
                        <th>Name</th>
                        <th>Location</th>
                        <th>S/P</th>
                        <th>ITU</th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                </div>
            </div>
            <p class="no-results">{% trans %}(No listeners found matching your criteria){% endtrans %}</p>
        </td>
        <td>
            <div class="content map">
                <div>
                    <div id="header">
                        <div class="form_layers">
                            <div><label><strong>Show</strong></label></div>
                            <div><label title="Show Maidenhead Locator Grid Squares"><input type="checkbox" id="layer_grid" checked="checked" /> Grid</label></div>
                            <div><label title="Show Primary locations"><input type="checkbox" id="layer_primary" checked="checked" /> Primary</label></div>
                            <div><label title="Show Secondary locations"><input type="checkbox" id="layer_secondary" checked="checked" /> Secondary</label></div>
                        </div>
                        <div class="form_layers">
                            <div><label><strong>Key:</strong></label></div>
                            <div><label title="Primary Location"><img src="{{ asset('image/map_point3.gif') }}" alt="Primary Location" style="height:0.8em; width: 0.8em"/>Primary</label></div>
                            <div><label title="Secondary Location"><img src="{{ asset('image/map_point4.gif') }}" alt="Secondary Location" style="height:0.8em; width: 0.8em; opacity: 0.8" />Secondary</label></div>
                        </div>
                    </div>
                    <div id="map"></div>
                </div>
            </div>
        </td>
    </tr>

    </tbody>
</table>